<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Steganography - Securing Technologies Exercises</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href=".././theme/pagetoc.css">
        <link rel="stylesheet" href=".././theme/css/mdbook-admonish.css">
        <link rel="stylesheet" href=".././theme/css/code.css">
        <link rel="stylesheet" href=".././theme/css/terminal.css">
        <link rel="stylesheet" href=".././theme/css/output.css">
        <link rel="stylesheet" href=".././theme/css/film.css">
        <link rel="stylesheet" href=".././theme/css/mdbook-admonish.css">

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="dracula">Dracula</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="frappe">Frappé</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="kanagawa">Knagawa</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="macchiato">Macchiato</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="mocha">Mocha</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="pinkrose">Pinkrose</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="tender">Tender</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="tokyonight">Tokyonight</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Securing Technologies Exercises</h1>

                    <div class="right-buttons">
                        <a href="https://github.com/uniofgreenwich/ELEE1171_Exercises" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>
                        <a href="https://github.com/uniofgreenwich/ELEE1171_Exercises/edit/main/content/Steganography/Steganography.md" title="Suggest an edit" aria-label="Suggest an edit">
                            <i id="git-edit-button" class="fa fa-edit"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <div class="search-wrapper">
                            <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                            <div class="spinner-wrapper">
                                <i class="fa fa-spinner fa-spin"></i>
                            </div>
                        </div>
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="steganography"><a class="header" href="#steganography">Steganography</a></h1>
<div id="admonition-info" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-title">
<div class="admonition-title">
<div id="admonition-info-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="#admonition-info"></a>
</div>
<div>
<p>By the end of this lab you should be able to:</p>
<ul>
<li>
<p>Explain the difference between encryption and steganography</p>
</li>
<li>
<p>Encode and decode messages using LSB image steganography</p>
</li>
<li>
<p>Detect steganography using forensic tools</p>
</li>
<li>
<p>Understand and apply text-based stego techniques</p>
</li>
<li>
<p>Reflect on steganography as a tool for privacy, security, and deception</p>
</li>
</ul>
</div>
</div>
<h2 id="part-1-lsb-steganography-with-images"><a class="header" href="#part-1-lsb-steganography-with-images">Part 1: LSB Steganography with Images</a></h2>
<h3 id="task-11-encode-a-message-in-a-png-using-encodepy"><a class="header" href="#task-11-encode-a-message-in-a-png-using-encodepy">Task 1.1: Encode a message in a PNG using <code>encode.py</code></a></h3>
<ol>
<li>
<p>Firstly, create a script in a new folder called <code>stego/encode.py</code></p>
 <div id="admonition-terminal" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-title">
 <div class="admonition-title">
 <div id="admonition-terminal-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal"></a>
 </div>
 <div>
<pre><code class="language-sh">$ mkdir stego &amp;&amp; touch stego/encode.py
</code></pre>
 </div>
 </div>
</li>
<li>
<p>Open the <code>stego/encode.py</code> in your text editor of choice (I am using <code>vim</code>):</p>
 <div id="admonition-terminal-1" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-1-title">
 <div class="admonition-title">
 <div id="admonition-terminal-1-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-1"></a>
 </div>
 <div>
<pre><code>$ cd stego/ 
$ vim encode.py
</code></pre>
 </div>
 </div>
</li>
<li>
<p>Reproduce the following code:</p>
 <details id="admonition-encodepy-53-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-encodepy-53-lines-title">
 <summary class="admonition-title">
 <div id="admonition-encodepy-53-lines-title">
<p>encode.py, 53 lines</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-encodepy-53-lines"></a>
 </summary>
 <div>
<pre><code class="language-py">from PIL import Image
import sys

def encode(image_path, output_path, message, bit_plane):
    if bit_plane &lt; 1 or bit_plane &gt; 7:
        raise ValueError("Bit plane must be between 1 and 7")

    img = Image.open(image_path)
    img = img.convert('RGBA')
    binary_msg = ''.join(f"{ord(c):08b}" for c in message) + '00000000'  # NULL terminator

    pixels = list(img.getdata())
    encoded_pixels = []

    bit_idx = 0
    mask = 1 &lt;&lt; (bit_plane - 1)
    inverse_mask = 255 - mask

    for r, g, b, ain pixels:
        if bit_idx &lt; len(binary_msg):
            r = (r &amp; inverse_mask) | (int(binary_msg[bit_idx]) &lt;&lt; (bit_plane - 1))
            bit_idx += 1
        if bit_idx &lt; len(binary_msg):           
            g = (g &amp; inverse_mask) | (int(binary_msg[bit_idx]) &lt;&lt; (bit_plane - 1))
            bit_idx += 1
        if bit_idx &lt; len(binary_msg):
            b = (b &amp; inverse_mask) | (int(binary_msg[bit_idx]) &lt;&lt; (bit_plane - 1))
            bit_idx += 1
        encoded_pixels.append((r, g, b, sca))

    img.putdata(encoded_pixels)
    img.save(output_path)
    print(f"Message encoded and saved to: {output_path}")

if __name__ == "__main__":
    if len(sys.argv) != 5:
        print("Usage: encode.py &lt;input_image&gt; &lt;output_image&gt; &lt;message&gt; &lt;bit_plane&gt;")
        sys.exit(1)

    input_path = sys.argv[1]
    output_path = sys.argv[2]
    message = sys.argv[3]
    try:
        bit_plane = int(sys.argv[4])
    except ValueError:
        print("Bit plane must be an integer between 1 and 7")
        sys.exit(1)

    try:
        encode(input_path, output_path, message, bit_plane)
    except Exception as e:
        print(f"Error: {e}")
        sys.exit(1)
</code></pre>
 </div>
 </details>
 <details id="admonition-explanation" class="admonition admonish-example" role="note" aria-labelledby="admonition-explanation-title">
 <summary class="admonition-title">
 <div id="admonition-explanation-title">
<p>Explanation</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-explanation"></a>
 </summary>
 <div>
<p><strong>Convert the Message to Binary</strong></p>
<pre><code class="language-py">binary_msg = ''.join(f"{ord(c):08b}" for c in message) + '00000000'
</code></pre>
<ul>
<li>
<p><code>ord(c)</code> converts each character (e.g., 'A') to its ASCII value (65)</p>
</li>
<li>
<p><code>f"{...:08b}"</code> formats it as 8-bit binary (<code>'01000001'</code>)</p>
</li>
<li>
<p><code>'00000000'</code> is a null terminator, signalling the end of the message</p>
<ul>
<li>"This" → <code>01010100 01101000 01101001 01110011</code> + <code>00000000</code></li>
</ul>
</li>
</ul>
<p><strong>Bit Mask Setup</strong></p>
<pre><code class="language-py">mask = 1 &lt;&lt; (bit_plane - 1)
inverse_mask = 255 - mask
</code></pre>
<ul>
<li>
<p>These control which bit of the byte we modify:</p>
<ul>
<li><code>1 &lt;&lt; (bit_plane - 1)</code> shifts 1 left to target the desired bit.</li>
</ul>
  <br>
<div class="table-wrapper"><table><thead><tr><th>Bit Plane</th><th>Binary</th><th>Decimal</th></tr></thead><tbody>
<tr><td>1 (LSB)</td><td>00000001</td><td>1</td></tr>
<tr><td>2</td><td>00000010</td><td>2</td></tr>
<tr><td>3</td><td>00000100</td><td>4</td></tr>
<tr><td>...</td><td>...</td><td>...</td></tr>
</tbody></table>
</div></li>
<li>
<p><code>mask = 0b00000100</code> (for bit plane 3)</p>
</li>
<li>
<p><code>inverse_mask = 0b11111011</code> — used to clear the target bit</p>
</li>
</ul>
<p><strong>Iterate Through Pixels and Modify Bits</strong></p>
<pre><code class="language-py">for r, g, b in pixels:
if bit_idx &lt; len(binary_msg):
    r = (r &amp; inverse_mask) | (int(binary_msg[bit_idx]) &lt;&lt; (bit_plane - 1))
</code></pre>
<ul>
<li>
<p>Let’s break this math down:</p>
<ul>
<li>
<p><code>r &amp; inverse_mask</code>: clears the target bit</p>
<p>e.g., <code>r = 10110110</code>, <code>mask = 11111011</code> → <code>10110010</code></p>
</li>
<li>
<p><code>(int(binary_msg[bit_idx]) &lt;&lt; (bit_plane - 1))</code>:</p>
<ul>
<li>
<p>Converts the current binary digit (<code>0</code> or <code>1</code>) into the correct bit position</p>
</li>
<li>
<p>If <code>bit_plane = 3</code> and bit = <code>1</code>, you shift: <code>1 &lt;&lt; 2 = 0b00000100</code></p>
</li>
</ul>
</li>
<li>
<p><code>|</code> (bitwise OR) inserts the bit</p>
<ul>
<li>This replaces just 1 bit in the color channel, leaving the rest untouched.</li>
</ul>
</li>
<li>
<p>The same logic is applied to G and B if more bits remain.</p>
</li>
</ul>
</li>
</ul>
<p><strong>Update the Image and Save</strong></p>
<pre><code class="language-py">img.putdata(encoded_pixels)
img.save(output_path)
</code></pre>
<ul>
<li>This writes your modified pixel data back and saves the output image.</li>
</ul>
<p><strong>Visual Summary (Example for R = 182, bit_plane = 3, bit = 1)</strong></p>
<div class="table-wrapper"><table><thead><tr><th>Step</th><th>Binary</th><th>Decimal</th></tr></thead><tbody>
<tr><td>Original R</td><td><code>10110110</code></td><td>182</td></tr>
<tr><td>Clear bit 3</td><td><code>10110010</code></td><td>178</td></tr>
<tr><td>Bit to embed (<code>1</code>)</td><td><code>00000100</code></td><td>4</td></tr>
<tr><td>New R</td><td><code>10110110</code></td><td>182</td></tr>
</tbody></table>
</div>
<p>If bit = <code>0</code>:</p>
<p>| Clear + 0 → <code>10110010</code> | = 178 (b3 cleared)</p>
 </div>
 </details>
</li>
<li>
<p>Copy ,<code>cp</code>, the watefall_image from <code>/opt/gre/steganography_lab/waterfall_image.png</code> to the current directory and then run the program supplying the file name and other arguments as shown here:</p>
 <div id="admonition-terminal-2" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-2-title">
 <div class="admonition-title">
 <div id="admonition-terminal-2-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-2"></a>
 </div>
 <div>
<pre><code class="language-sh">$ cp /opt/gre/steganography_lab/waterfall_image.png .
$ python3 encode.py waterfall_image.png waterfall_image_stego_1.png "TEST" 1
$ python3 encode.py waterfall_image.png waterfall_image_stego_2.png "TEST" 2
$ python3 encode.py waterfall_image.png waterfall_image_stego_3.png "TEST" 3
</code></pre>
<ul>
<li><code>python3 encode.py input_file output_file message bit_plane</code></li>
</ul>
 </div>
 </div>
</li>
<li>
<p>Open images side by side using</p>
 <div id="admonition-terminal-3" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-3-title">
 <div class="admonition-title">
 <div id="admonition-terminal-3-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-3"></a>
 </div>
 <div>
<pre><code class="language-sh">$ feh -i -X -W 1476 -y 350 -E 700 iceland_waterfall*
</code></pre>
 </div>
 </div>
 <div id="admonition-output" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-title">
 <div class="admonition-title">
 <div id="admonition-output-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output"></a>
 </div>
 <div>
<p><img src="./figures/iceland_waterfall_feh.png" alt="" /></p>
<p>Notice how even though we modified the LSB the original file has decreased by 100k.</p>
 </div>
 </div>
</li>
<li>
<p>Now use <code>pngcheck</code> to check the integrity of the <code>*.png</code></p>
 <div id="admonition-terminal-4" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-4-title">
 <div class="admonition-title">
 <div id="admonition-terminal-4-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-4"></a>
 </div>
 <div>
<pre><code class="language-sh">$ pngcheck -ts iceland_waterfall*
</code></pre>
 </div>
 </div>
 <details id="admonition-output-1" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-1-title">
 <summary class="admonition-title">
 <div id="admonition-output-1-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output-1"></a>
 </summary>
 <div>
<pre><code class="language-sh">OK: iceland_waterfall.png         (499x888, 32-bit RGB+alpha, non-interlaced, 51.1%).
OK: iceland_waterfall_stego_1.png (499x888, 32-bit RGB+alpha, non-interlaced, 51.3%).
OK: iceland_waterfall_stego_2.png (499x888, 32-bit RGB+alpha, non-interlaced, 51.3%).
OK: iceland_waterfall_stego_3.png (499x888, 32-bit RGB+alpha, non-interlaced, 51.3%).

No errors were detected in 4 of the 4 files tested.
</code></pre>
<p>The images are structurally valid and pass PNG validation — which demonstrates how well steganography can hide in plain sight, even when tools like <code>pngcheck</code> say 'OK'</p>
<p>Though we know that because we have the original to compare against, we do use the change in non-interlaced by 0.2%.</p>
 </div>
 </details>
</li>
<li>
<p>Experiment with <code>pngcheck</code>, see <code>pngcheck --help</code> or <code>man pngcheck</code> to see what else you can do?</p>
</li>
</ol>
<h3 id="task-12-reflection"><a class="header" href="#task-12-reflection">Task 1.2: Reflection</a></h3>
<details id="admonition-how-does-bit-plane-depth-affect-detectability-and-capacity" class="admonition admonish-question" role="note" aria-labelledby="admonition-how-does-bit-plane-depth-affect-detectability-and-capacity-title">
<summary class="admonition-title">
<div id="admonition-how-does-bit-plane-depth-affect-detectability-and-capacity-title">
<p>How does bit plane depth affect detectability and capacity?</p>
</div>
<a class="admonition-anchor-link" href="#admonition-how-does-bit-plane-depth-affect-detectability-and-capacity"></a>
</summary>
<div>
<p><strong>Bit Plane = Position Within a Byte</strong></p>
<p>Each pixel color channel (Red, Green, Blue) is stored as an 8-bit number:</p>
<pre><code>Bit positions: [7][6][5][4][3][2][1][0]  ← Bit plane
               MSB                  LSB
</code></pre>
<ul>
<li>
<p><strong>b1 (LSB)</strong>: smallest visual impact</p>
</li>
<li>
<p><strong>b8 (MSB)</strong>: largest impact — most noticeable</p>
</li>
</ul>
<p><strong>Impact breakdown</strong></p>
<div class="table-wrapper"><table><thead><tr><th><strong>Bit Plane</strong></th><th><strong>Capacity</strong></th><th><strong>Image Impact</strong></th><th><strong>Detectability</strong></th></tr></thead><tbody>
<tr><td><strong>b1 (LSB)</strong></td><td>Low</td><td>Imperceptible</td><td>Hard</td></tr>
<tr><td><strong>b2</strong></td><td>Medium</td><td>Barely visible</td><td>Medium</td></tr>
<tr><td><strong>b3</strong></td><td>Higher</td><td>Slight noise</td><td>Detectable</td></tr>
<tr><td><strong>b4–b7</strong></td><td>Very High</td><td>Noticeable artifacts</td><td>Easy</td></tr>
</tbody></table>
</div>
<p><strong>Capacity vs. Quality Trade-off</strong></p>
<ul>
<li>
<p>Each pixel has 3 channels (RGB) → up to <strong>3 bits per pixel</strong> at b1</p>
</li>
<li>
<p>Want more capacity? → use <code>b2</code>, <code>b3</code>, etc.</p>
</li>
<li>
<p>But: Each jump doubles the impact</p>
<div class="table-wrapper"><table><thead><tr><th>Bits Used</th><th>Max Data (in a 500×500 image)</th><th>Typical Use</th></tr></thead><tbody>
<tr><td>b1 only</td><td>~93 KB</td><td>Safe/secret</td></tr>
<tr><td>b1+b2</td><td>~187 KB</td><td>Higher cap</td></tr>
<tr><td>b1–b3</td><td>~281 KB</td><td>Noticeable</td></tr>
</tbody></table>
</div></li>
</ul>
<p><strong>Detectability:</strong></p>
<p>Detection tools like <code>zsteg</code>, <code>stegdetect</code>, and statistical methods (e.g. chi-square, RS analysis):</p>
<ul>
<li>
<p>Are <strong>tuned to spot unnatural patterns</strong> in LSBs</p>
</li>
<li>
<p>Higher bit planes (b3–b5) introduce more noise → easier to detect</p>
</li>
<li>
<p>Even <strong>visual diffing</strong> can expose b3 or b4 usage</p>
</li>
</ul>
<p><strong>Summary</strong></p>
<p>Think of it like whispering into a noisy room:</p>
<ul>
<li>
<p>b1 = whisper (hard to detect)</p>
</li>
<li>
<p>b3 = speaking clearly (someone might hear)</p>
</li>
<li>
<p>b6+ = shouting (anyone can spot it)</p>
</li>
</ul>
</div>
</details>
<hr />
<h2 id="part-2-steganalysis-tools"><a class="header" href="#part-2-steganalysis-tools">Part 2: Steganalysis Tools</a></h2>
<div id="admonition-info-1" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-1-title">
<div class="admonition-title">
<div id="admonition-info-1-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="#admonition-info-1"></a>
</div>
<div>
<p>Third party tools: <code>zsteg</code>, <code>binwalk</code>, <code>exiftool</code>, <code>stegsolve</code></p>
<p>Our tool: <code>decode.py</code></p>
</div>
</div>
<h3 id="task-21-analyze-a-stego-image-with-zsteg-and-extract-message"><a class="header" href="#task-21-analyze-a-stego-image-with-zsteg-and-extract-message">Task 2.1: Analyze a stego image with <code>zsteg</code> and extract message</a></h3>
<p>So far we have seen the results of enccoding text into images. We should therefore try to extract the text.</p>
<ol>
<li>
<p>Using <code>s</code> to try to extract the message out of bit plane 1, <code>iceland_waterfall_stego_1.png</code></p>
 <div id="admonition-terminal-5" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-5-title">
 <div class="admonition-title">
 <div id="admonition-terminal-5-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-5"></a>
 </div>
 <div>
<pre><code class="language-sh">$ zsteg iceland_waterfall_stego_1.png
</code></pre>
 </div>
 </div>
 <details id="admonition-output-2" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-2-title">
 <summary class="admonition-title">
 <div id="admonition-output-2-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output-2"></a>
 </summary>
 <div>
<pre><code></code></pre>
 </div>
 </details>
<ul>
<li>Repeat for the other two <code>iceland_waterfall_stego_2.png</code> and <code>iceland_waterfall_stego_3.png</code></li>
</ul>
</li>
</ol>
<h3 id="task-22-decodepy"><a class="header" href="#task-22-decodepy">Task 2.2 <code>decode.py</code></a></h3>
<ol>
<li>
<p>Let's try and decode this ourselves using a python script will be write, Create a new python file called <code>decode.py</code> and reproduce the following</p>
 <details id="admonition-decodepy-35-lines" class="admonition admonish-code" role="note" aria-labelledby="admonition-decodepy-35-lines-title">
 <summary class="admonition-title">
 <div id="admonition-decodepy-35-lines-title">
<p>decode.py, 35 lines</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-decodepy-35-lines"></a>
 </summary>
 <div>
<pre><code class="language-py">from PIL import Image
import sys

def decode(image_path, bit_plane):
    if bit_plane &lt; 1 or bit_plane &gt; 7:
        raise ValueError("Bit plane must be between 1 and 7")

    img = Image.open(image_path)
    img = img.convert('RGB')
    pixels = list(img.getdata())

    bits = []
    mask = 1 &lt;&lt; (bit_plane - 1)

    for r, g, b in pixels:
        bits.append(str((r &amp; mask) &gt;&gt; (bit_plane - 1)))
        bits.append(str((g &amp; mask) &gt;&gt; (bit_plane - 1)))
        bits.append(str((b &amp; mask) &gt;&gt; (bit_plane - 1)))

    chars = []
    for i in range(0, len(bits), 8):
        byte = ''.join(bits[i:i+8])
        if byte == '00000000':  # NULL terminator
            break
        chars.append(chr(int(byte, 2)))

    message = ''.join(chars)
    print("Decoded message:", message)

if __name__ == "__main__":
    if len(sys.argv) != 3:
        print("Usage: decode.py &lt;image&gt; &lt;bit_plane&gt;")
        sys.exit(1)

    image_path = sys.argv[1]
    try:
        bit_plane = int(sys.argv[2])
    except ValueError:
        print("Bit plane must be an integer between 1 and 7")
        sys.exit(1)

    try:
        decode(image_path, bit_plane)
    except Exception as e:
        print(f"❌ Error: {e}")
        sys.exit(1)
</code></pre>
 </div>
 </details>
 <details id="admonition-explanation-1" class="admonition admonish-example" role="note" aria-labelledby="admonition-explanation-1-title">
 <summary class="admonition-title">
 <div id="admonition-explanation-1-title">
<p>Explanation</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-explanation-1"></a>
 </summary>
 <div>
 </div>
 </details>
</li>
</ol>
<h3 id="task-23-what-about-file---mime-type"><a class="header" href="#task-23-what-about-file---mime-type">Task 2.3: What about <code>file --mime-type</code>?</a></h3>
<p>The utility <code>file</code> can tell you what the magic number of the file is. Useful for matching extentsion to the acutal file encoding.</p>
<div id="admonition-note" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-title">
<div class="admonition-title">
<div id="admonition-note-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="#admonition-note"></a>
</div>
<div>
<p>A magic number is a sequence of bytes at the beginning of a file that allows to identify which is the type of a file</p>
<p>For instance the magic number for a png is <strong>89 50 4E 47</strong>. Likewise a shell script is <strong>23 21</strong>
<code>#!</code> is encoded to the <strong>bytes 23 21</strong> which is the <strong>magic number</strong> of an executable script.</p>
</div>
</div>
<ol>
<li>
<p>Do this quickly, which will demonstrate the above</p>
 <div id="admonition-terminal-6" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-6-title">
 <div class="admonition-title">
 <div id="admonition-terminal-6-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-6"></a>
 </div>
 <div>
<pre><code class="language-sh">$ cp iceland_watefall.png iceland_watefall.txt 
</code></pre>
 </div>
 </div>
</li>
<li>
<p>Now you can do two things first run</p>
 <div id="admonition-terminal-7" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-7-title">
 <div class="admonition-title">
 <div id="admonition-terminal-7-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-7"></a>
 </div>
 <div>
<pre><code class="language-sh">$ file --mime-type iceland_waterfall.txt
</code></pre>
 </div>
 </div>
 <details id="admonition-output-3" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-3-title">
 <summary class="admonition-title">
 <div id="admonition-output-3-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output-3"></a>
 </summary>
 <div>
<pre><code>iceland_waterfall.txt: image/png
</code></pre>
<p>Still recognised as a png, despite the extension change.</p>
 </div>
 </details>
</li>
<li>
<p>We can look at hex with <code>xxd</code> tool.</p>
 <div id="admonition-terminal-8" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-8-title">
 <div class="admonition-title">
 <div id="admonition-terminal-8-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-8"></a>
 </div>
 <div>
<pre><code class="language-sh">$ xxd iceland_waterfall.txt | head -n1
</code></pre>
 </div>
 </div>
 <details id="admonition-output-4" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-4-title">
 <summary class="admonition-title">
 <div id="admonition-output-4-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output-4"></a>
 </summary>
 <div>
<pre><code>00000000: 8950 4e47 0d0a 1a0a 0000 000d 4948 4452  .PNG........IHDR
</code></pre>
<p>See how the magic number is <code>8950 4E47</code>... it is still encoded as a png!</p>
 </div>
 </details>
</li>
</ol>
<h3 id="task-24-open-image-in-stegsolve-and-visually-inspect-bit-planes"><a class="header" href="#task-24-open-image-in-stegsolve-and-visually-inspect-bit-planes">Task 2.4: Open image in <code>stegsolve</code> and visually inspect bit planes</a></h3>
<hr />
<h2 id="part-3-text-based-steganography"><a class="header" href="#part-3-text-based-steganography">Part 3: Text-Based Steganography</a></h2>
<div id="admonition-info-2" class="admonition admonish-info" role="note" aria-labelledby="admonition-info-2-title">
<div class="admonition-title">
<div id="admonition-info-2-title">
<p>Info</p>
</div>
<a class="admonition-anchor-link" href="#admonition-info-2"></a>
</div>
<div>
<p>Tools: <code>snow</code>, <code>cat</code> and <code>od</code></p>
</div>
</div>
<h3 id="task-31-use-snow-to-hide-a-message-in-a-txt-file-via-whitespace"><a class="header" href="#task-31-use-snow-to-hide-a-message-in-a-txt-file-via-whitespace">Task 3.1: Use <code>snow</code> to hide a message in a <code>.txt</code> file via whitespace</a></h3>
<div id="admonition-note-1" class="admonition admonish-note" role="note" aria-labelledby="admonition-note-1-title">
<div class="admonition-title">
<div id="admonition-note-1-title">
<p>Note</p>
</div>
<a class="admonition-anchor-link" href="#admonition-note-1"></a>
</div>
<div>
<ul>
<li>
<p><code>snow</code> has been packaged and deployed from here <a href="https://github.com/CompEng0001/snow">https://github.com/CompEng0001/snow</a></p>
<ul>
<li>
<p>The program is used to conceal messages in ASCII text by appending whitespace to the end of lines. Because spaces and tabs are generally not visible in text viewers, the message is effectively hidden from casual observers. And if the built-in encryption is used, the message cannot be read even if it is detected.</p>
</li>
<li>
<p>SNOW exploits the Steganographic Nature Of Whitespace. Locating trailing whitespace in text is like finding a polar bear in a snowstorm (which, by the way, explains the logo). And it uses the ICE encryption algorithm, so the name is thematically consistent.</p>
</li>
</ul>
</li>
</ul>
</div>
</div>
<ol>
<li>
<p>Let's look at <code>snow</code>'s man page, read to understand how it works.</p>
<div id="admonition-terminal-9" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-9-title">
<div class="admonition-title">
<div id="admonition-terminal-9-title">
<p>Terminal</p>
</div>
<a class="admonition-anchor-link" href="#admonition-terminal-9"></a>
</div>
<div>
<pre><code class="language-sh">$ man snow
</code></pre>
</div>
</div>
</li>
<li>
<p>Create a file called <code>snow_in.txt</code> and fill it with the following:</p>
 <div id="admonition-code" class="admonition admonish-code" role="note" aria-labelledby="admonition-code-title">
 <div class="admonition-title">
 <div id="admonition-code-title">
<p>Code</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-code"></a>
 </div>
 <div>
<pre><code>Lorem Ipsum comes from a latin text written in 45BC by Roman statesman, lawyer, scholar, and philosopher, Marcus Tullius Cicero.

The text is titled "de Finibus Bonorum et Malorum" which means "The Extremes of Good and Evil". The most common form of Lorem ipsum is the following:

Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.

Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
</code></pre>
 </div>
 </div>
</li>
<li>
<p>Now use <code>snow</code> to encode <code>TEST</code> into the file <code>snow_in.txt</code> to <code>snow_out.txt</code>:</p>
 <div id="admonition-terminal-10" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-10-title">
 <div class="admonition-title">
 <div id="admonition-terminal-10-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-10"></a>
 </div>
 <div>
<pre><code class="language-sh">$ snow -C -m "TEST" snow_in.txt snow_out.txt
</code></pre>
 </div>
 </div>
 <div id="admonition-terminal-11" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-11-title">
 <div class="admonition-title">
 <div id="admonition-terminal-11-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-11"></a>
 </div>
 <div>
<pre><code>Compressed by 0.00%
Message used approximately 34.41% of available space.
</code></pre>
 </div>
 </div>
</li>
</ol>
<h3 id="task-32-extract-and-decode-the-message"><a class="header" href="#task-32-extract-and-decode-the-message">Task 3.2: Extract and decode the message</a></h3>
<ol>
<li>
<p>Now we try to extract the hidden text from <code>snow_out.txt</code> file using <code>snow</code></p>
 <div id="admonition-terminal-12" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-12-title">
 <div class="admonition-title">
 <div id="admonition-terminal-12-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-12"></a>
 </div>
 <div>
<pre><code class="language-sh">$ snow -C snow_out.txt
</code></pre>
 </div>
 </div>
 <div id="admonition-output-5" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-5-title">
 <div class="admonition-title">
 <div id="admonition-output-5-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output-5"></a>
 </div>
 <div>
<pre><code class="language-sh">$ TEST
</code></pre>
 </div>
 </div>
</li>
</ol>
<h3 id="task-33-inspect-files-with-cat-and-od-to-reveal-anomalies"><a class="header" href="#task-33-inspect-files-with-cat-and-od-to-reveal-anomalies">Task 3.3: Inspect files with <code>cat</code>, and <code>od</code> to reveal anomalies</a></h3>
<ol>
<li>
<p>Let's see how detectable stegnography in text is, we will use <code>od</code> and <code>cat</code> to see what is going on. Find a way to use <code>cat</code> to determine the content of the file, hint you may need to pass in arguments to <code>cat</code> (see <code>man cat</code>)</p>
 <details id="admonition-terminal-13" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-13-title">
 <summary class="admonition-title">
 <div id="admonition-terminal-13-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-13"></a>
 </summary>
 <div>
<pre><code>$ cat -A snow_out.txt
</code></pre>
 </div>
 </details>
 <details id="admonition-output-6" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-6-title">
 <summary class="admonition-title">
 <div id="admonition-output-6-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output-6"></a>
 </summary>
 <div>
<pre><code>Lorem Ipsum comes from a latin text written in 45BC by Roman statesman, lawyer, scholar, and philosopher, Marcus Tullius Cicero.$
^I     ^I      ^I ^I  ^I    ^I  ^I ^I ^I     $
The text is titled "de Finibus Bonorum et Malorum" which means "The Extremes of Good and Evil". The most common form of Lorem ipsum is the following:$
    ^I $
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.$
$
Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur.$
$
Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.$
</code></pre>
<p>We can see that there are  extra whitespace and <code>^I</code> indicating tabs embedded after the first line. This is the encoded message.</p>
 </div>
 </details>
</li>
<li>
<p>If you compare this to the original file <code>snow_in.txt</code></p>
 <details id="admonition-terminal-14" class="admonition admonish-terminal" role="note" aria-labelledby="admonition-terminal-14-title">
 <summary class="admonition-title">
 <div id="admonition-terminal-14-title">
<p>Terminal</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-terminal-14"></a>
 </summary>
 <div>
<pre><code>$ cat -A snow_in.txt
</code></pre>
 </div>
 </details>
 <details id="admonition-output-7" class="admonition admonish-output" role="note" aria-labelledby="admonition-output-7-title">
 <summary class="admonition-title">
 <div id="admonition-output-7-title">
<p>Output</p>
 </div>
 <a class="admonition-anchor-link" href="#admonition-output-7"></a>
 </summary>
 <div>
<pre><code>Lorem Ipsum comes from a latin text written in 45BC by Roman statesman, lawyer, scholar, and philosopher, Marcus Tullius Cicero. $
$
The text is titled "de Finibus Bonorum et Malorum" which means "The Extremes of Good and Evil". The most common form of Lorem ipsum is the following:$
$
Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.$
$
Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. $
$
Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.$
</code></pre>
 </div>
 </details>
</li>
</ol>
<h3 id="challenge"><a class="header" href="#challenge">Challenge</a></h3>
<div id="admonition-todo" class="admonition admonish-info" role="note" aria-labelledby="admonition-todo-title">
<div class="admonition-title">
<div id="admonition-todo-title">
<p>Todo</p>
</div>
<a class="admonition-anchor-link" href="#admonition-todo"></a>
</div>
<div>
<ol>
<li>
<p>Try and encode/decode messages to each other using just <code>encode/decode{.py}</code></p>
</li>
<li>
<p>Try to experiment with <code>snow</code></p>
</li>
<li>
<p>combine snow with encode... could you encode some text as the messsage that is embedded in the each pixel of an image?</p>
</li>
</ol>
</div>
</div>
<div id="admonition-warning" class="admonition admonish-warning" role="note" aria-labelledby="admonition-warning-title">
<div class="admonition-title">
<div id="admonition-warning-title">
<p>Warning</p>
</div>
<a class="admonition-anchor-link" href="#admonition-warning"></a>
</div>
<div>
<p>Do <strong>not</strong> embed payloads and any messge must be clean of defamatory marks and must not cause offense</p>
<p>Legal concerns, the skills/knowledge you are gaining/demonstrating here are for education purposes and should not be used in a way to break the law.</p>
</div>
</div>
<style>.scroll-to-top { font-size: 2.5rem; width: 3.2rem; height: 3.2rem; display: none; align-items: center; justify-content: center; position: fixed; padding: 0.75rem; bottom: 4rem; right: calc(1.25rem + 90px + var(--page-padding)); z-index: 999; cursor: pointer; border: none; color: var(--bg); background: var(--fg); border-radius: 50%; } .scroll-to-top.hidden { display: none; } .scroll-to-top i { transform: translateY(-2px); } @media (min-width: 1080px) { .scroll-to-top { display: flex; } }</style><button type="button" aria-label="scroll-to-top" class="scroll-to-top hidden" onclick="scrollToTop()"> <i class="fa fa-angle-up"></i></button><script>const scrollToTop = () => window.scroll({ top: 0, behavior: "smooth" }); window.addEventListener("scroll", () => { const button = document.querySelector(".scroll-to-top"); button.classList.toggle("hidden", window.scrollY <200); });</script><style>footer { text-align: center; text-wrap: balance; margin-top: 5rem; display: flex; flex-direction: column; justify-content: center; align-items: center; } footer p { margin: 0; }</style><footer><p>Copyright © 2025 • Created with ❤️ by <a href="https://github.com/CompEng0001">CompEng0001</a></p></footer>
<footer><span class="gitinfo-footer" style="font-size:0.8em;padding:4px;margin:0.5em 0;text-align:right;display:block;">Page last updated: Monday 14 July 2025 @ 10:45:45 | Commit: e2cf15d</span></footer>
                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../Cryptography/Cryptography.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../CVE/CVE.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../Cryptography/Cryptography.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../CVE/CVE.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src=".././theme/pagetoc.js"></script>
        <script src=".././theme/highlightjs-line-numbers.js"></script>


    </div>
    </body>
</html>